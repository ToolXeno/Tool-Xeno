<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Sign PDF - Digital Signature Tool | Tool Xeno</title>
    <meta name="description" content="Advanced PDF e-signature tool with digital certificates, timestamp validation, and signature management">

    <!-- ✅ Tool Xeno Favicons -->
<link rel="icon" type="image/svg+xml" href="toolxeno-logo.svg">
<link rel="alternate icon" type="image/png" href="toolxeno-logo.png">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" href="toolxeno-logo.png">
<meta name="theme-color" content="#667eea">

    <!-- External Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- PDF.js -->
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' stop-color='%23667eea'/><stop offset='100%' stop-color='%23764ba2'/></linearGradient></defs><rect width='100' height='100' rx='15' fill='url(%23g)'/><path fill='white' d='M30,30 L70,30 L70,40 L40,40 L40,50 L65,50 L65,60 L40,60 L40,70 L30,70 Z'/></svg>">
    
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            
            --dark-bg: #0a0a0a;
            --dark-surface: #1a1a1a;
            --dark-surface-elevated: #252525;
            --dark-text: #ffffff;
            --dark-text-secondary: #a0a0a0;
            --dark-border: #333333;
            
            --light-bg: #f8fafc;
            --light-surface: #ffffff;
            --light-surface-elevated: #f1f5f9;
            --light-text: #1e293b;
            --light-text-secondary: #64748b;
            --light-border: #e2e8f0;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            transition: background-color 0.35s cubic-bezier(0.4, 0, 0.2, 1), color 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            line-height: 1.6;
            background-color: var(--dark-bg);
            color: var(--dark-text);
            min-height: 100vh;
        }
        
        body.light-theme { 
            background-color: var(--light-bg); 
            color: var(--light-text); 
        }

        .particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            border-radius: 50%;
            animation: float 20s infinite linear;
            opacity: 0.05;
            background: radial-gradient(circle, #667eea 0%, transparent 70%);
        }
        
        body.light-theme .particle { 
            background: radial-gradient(circle, #4facfe 0%, transparent 70%); 
        }
        
        @keyframes float { 
            0% { transform: translateY(100vh) rotate(0deg); } 
            100% { transform: translateY(-100px) rotate(360deg); } 
        }
        
        .header-glass {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background: rgba(0, 0, 0, 0.4);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: background-color 0.35s ease, border-color 0.35s ease;
        }
        
        body.light-theme .header-glass { 
            background: rgba(255, 255, 255, 0.9); 
            border-bottom-color: rgba(0, 0, 0, 0.1); 
        }
        
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            background: var(--dark-surface);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .theme-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            background: var(--primary-gradient);
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        body.light-theme .theme-toggle { 
            background: var(--light-surface-elevated); 
            border-color: var(--light-border); 
        }
        
        body.light-theme .theme-toggle::after { 
            transform: translateX(28px); 
            background: var(--secondary-gradient); 
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        body.light-theme .glass-card { 
            background-color: rgba(255, 255, 255, 0.9); 
            border-color: rgba(0, 0, 0, 0.1); 
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); 
        }
        
        .btn-gradient {
            background: var(--primary-gradient);
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
        }
        
        .btn-gradient:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); 
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px 24px;
            color: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        
        body.light-theme .btn-secondary {
            background: rgba(0, 0, 0, 0.05);
            border-color: rgba(0, 0, 0, 0.15);
        }
        
        body.light-theme .btn-secondary:hover {
            background: rgba(0, 0, 0, 0.1);
        }
        
        .upload-zone {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 60px 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .upload-zone:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }
        
        .upload-zone.dragover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.02);
        }
        
        body.light-theme .upload-zone {
            border-color: rgba(0, 0, 0, 0.2);
        }
        
        body.light-theme .upload-zone:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }
        
        .nav-link {
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
        }
        
        .nav-link:hover { 
            background: rgba(255, 255, 255, 0.1); 
            color: white; 
        }
        
        body.light-theme .nav-link { 
            color: rgba(0, 0, 0, 0.7); 
        }
        
        body.light-theme .nav-link:hover { 
            background: rgba(0, 0, 0, 0.1); 
            color: black; 
        }
        
        .pdf-viewer {
            background: #f5f5f5;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        body.light-theme .pdf-viewer {
            background: #ffffff;
        }
        
        .signature-canvas {
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            cursor: crosshair;
            background: rgba(255, 255, 255, 0.95);
        }
        
        body.light-theme .signature-canvas {
            border-color: rgba(0, 0, 0, 0.2);
        }
        
        .signature-preview {
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .signature-preview:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .signature-preview.active {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.15);
        }
        
        .tool-controls {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        body.light-theme .tool-controls {
            background: rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 16px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--primary-gradient);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .status-success {
            background: rgba(56, 239, 125, 0.2);
            color: #38ef7d;
            border: 1px solid rgba(56, 239, 125, 0.3);
        }
        
        .status-warning {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }
        
        .status-error {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }
        
        .signature-positioned {
            position: absolute;
            border: 2px dashed #667eea;
            cursor: move;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .signature-positioned:hover {
            border-color: #f5576c;
            background: rgba(245, 87, 108, 0.1);
        }
        
        .delete-signature {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 20px;
            height: 20px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            color: inherit;
            font-family: inherit;
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        body.light-theme .input-field {
            background: white;
            border-color: var(--light-border);
        }
        
        .dropdown-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 12px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
        }
        
        @media (max-width: 768px) {
            .section-title { font-size: 1.5rem; }
            .glass-card { margin: 10px 0; }
            .upload-zone { padding: 40px 15px; }
        }
    </style>
</head>

<body>
    <!-- Floating Particles -->
    <div class="particles-container" id="particles"></div>
    
    <!-- Header -->
    <header class="header-glass fixed w-full top-0 z-50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="#" class="flex items-center space-x-4">
                    <div class="text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                        🛠️ Tool Xeno
                    </div>
                    <div class="hidden md:block text-sm opacity-70">
                        E-Sign PDF Tool
                    </div>
                </a>
                <div class="flex items-center space-x-4">
                    <nav class="hidden md:flex space-x-2">
                        <a href="#upload" class="nav-link">Upload</a>
                        <a href="#sign" class="nav-link">Sign</a>
                        <a href="#download" class="nav-link">Download</a>
                    </nav>
                    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()"></button>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main Content -->
    <main class="pt-20 pb-10">
        <div class="container mx-auto px-6">
            
            <!-- Hero Section -->
            <div class="text-center mb-12">
                <h1 class="section-title">📝 E-Sign PDF Tool</h1>
                <p class="text-xl opacity-80 max-w-3xl mx-auto mb-8">
                    Professional PDF electronic signature tool with digital certificates, timestamp validation, and advanced signature management
                </p>
                
                <!-- Status Indicators -->
                <div class="flex flex-wrap justify-center gap-4 mb-8">
                    <div class="status-indicator status-success">
                        <i class="fas fa-shield-alt"></i>
                        <span>Secure Processing</span>
                    </div>
                    <div class="status-indicator status-success">
                        <i class="fas fa-certificate"></i>
                        <span>Digital Certificates</span>
                    </div>
                    <div class="status-indicator status-success">
                        <i class="fas fa-clock"></i>
                        <span>Timestamp Validation</span>
                    </div>
                </div>
            </div>
            
            <!-- Upload Section -->
            <section id="upload" class="mb-12">
                <div class="glass-card p-8">
                    <h2 class="text-2xl font-bold mb-6 text-center">
                        <i class="fas fa-upload mr-2"></i>
                        Upload PDF Document
                    </h2>
                    
                    <div class="upload-zone" id="uploadZone">
                        <div class="text-6xl mb-4 opacity-50">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-2">Drop your PDF here</h3>
                        <p class="opacity-70 mb-4">or click to browse files</p>
                        <button class="btn-gradient">
                            <i class="fas fa-folder-open mr-2"></i>
                            Choose PDF File
                        </button>
                        <input type="file" id="pdfFileInput" accept=".pdf" class="hidden">
                    </div>
                    
                    <div class="progress-bar hidden" id="uploadProgress">
                        <div class="progress-fill" id="uploadProgressFill"></div>
                    </div>
                    
                    <div id="fileInfo" class="hidden mt-6 p-4 rounded-lg bg-gradient-to-r from-green-400/10 to-blue-500/10 border border-green-400/20">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-semibold" id="fileName"></p>
                                <p class="text-sm opacity-70" id="fileSize"></p>
                            </div>
                            <div class="status-indicator status-success">
                                <i class="fas fa-check"></i>
                                <span>Ready to Sign</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Main Tool Interface -->
            <div class="grid grid-cols-1 xl:grid-cols-3 gap-8" id="mainInterface" style="display: none;">
                
                <!-- PDF Viewer -->
                <div class="xl:col-span-2">
                    <div class="glass-card p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-bold">PDF Document</h3>
                            <div class="flex items-center gap-2">
                                <button class="btn-secondary" id="zoomOut">
                                    <i class="fas fa-search-minus"></i>
                                </button>
                                <span id="zoomLevel" class="px-3 py-1 bg-white/10 rounded-lg text-sm">100%</span>
                                <button class="btn-secondary" id="zoomIn">
                                    <i class="fas fa-search-plus"></i>
                                </button>
                                <button class="btn-secondary" id="prevPage">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <span id="pageInfo" class="px-3 py-1 bg-white/10 rounded-lg text-sm">1 / 1</span>
                                <button class="btn-secondary" id="nextPage">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="pdf-viewer" id="pdfViewer">
                            <canvas id="pdfCanvas" class="w-full"></canvas>
                            <div id="signatureOverlay" class="absolute top-0 left-0 w-full h-full pointer-events-none"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Signature Tools -->
                <div>
                    <div class="glass-card p-6 mb-6">
                        <h3 class="text-xl font-bold mb-4">
                            <i class="fas fa-signature mr-2"></i>
                            Signature Tools
                        </h3>
                        
                        <!-- Signature Tabs -->
                        <div class="flex mb-6 bg-white/5 rounded-lg p-1">
                            <button class="flex-1 py-2 px-4 rounded-md transition-all signature-tab active" data-tab="draw">
                                <i class="fas fa-pencil-alt mr-2"></i>Draw
                            </button>
                            <button class="flex-1 py-2 px-4 rounded-md transition-all signature-tab" data-tab="type">
                                <i class="fas fa-keyboard mr-2"></i>Type
                            </button>
                            <button class="flex-1 py-2 px-4 rounded-md transition-all signature-tab" data-tab="upload">
                                <i class="fas fa-upload mr-2"></i>Upload
                            </button>
                        </div>
                        
                        <!-- Draw Signature -->
                        <div class="signature-content active" data-content="draw">
                            <div class="mb-4">
                                <canvas id="signatureCanvas" class="signature-canvas w-full" width="300" height="150"></canvas>
                            </div>
                            <div class="flex gap-2 mb-4">
                                <button class="btn-secondary flex-1" id="clearSignature">
                                    <i class="fas fa-eraser mr-2"></i>Clear
                                </button>
                                <button class="btn-gradient flex-1" id="saveSignature">
                                    <i class="fas fa-save mr-2"></i>Save
                                </button>
                            </div>
                            <div class="flex items-center gap-2 mb-4">
                                <label class="text-sm font-medium">Pen Size:</label>
                                <input type="range" id="penSize" min="1" max="10" value="2" class="flex-1">
                                <span id="penSizeDisplay" class="text-sm bg-white/10 px-2 py-1 rounded">2px</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <label class="text-sm font-medium">Color:</label>
                                <input type="color" id="penColor" value="#000000" class="w-10 h-8 rounded border-0">
                            </div>
                        </div>
                        
                        <!-- Type Signature -->
                        <div class="signature-content" data-content="type" style="display: none;">
                            <div class="mb-4">
                                <input type="text" id="signatureText" class="input-field" placeholder="Enter your signature text">
                            </div>
                            <div class="mb-4">
                                <select id="fontFamily" class="input-field dropdown-select">
                                    <option value="cursive">Cursive</option>
                                    <option value="Dancing Script">Dancing Script</option>
                                    <option value="Great Vibes">Great Vibes</option>
                                    <option value="Pacifico">Pacifico</option>
                                    <option value="Satisfy">Satisfy</option>
                                </select>
                            </div>
                            <div class="mb-4">
                                <label class="text-sm font-medium mb-2 block">Font Size:</label>
                                <input type="range" id="fontSize" min="20" max="72" value="36" class="w-full">
                                <span id="fontSizeDisplay" class="text-sm bg-white/10 px-2 py-1 rounded mt-2 inline-block">36px</span>
                            </div>
                            <div class="signature-preview-area mb-4 p-4 bg-white rounded-lg min-h-[100px] flex items-center justify-center">
                                <div id="textSignaturePreview" class="text-black" style="font-family: cursive; font-size: 36px;">Your Signature</div>
                            </div>
                            <button class="btn-gradient w-full" id="saveTextSignature">
                                <i class="fas fa-save mr-2"></i>Save Text Signature
                            </button>
                        </div>
                        
                        <!-- Upload Signature -->
                        <div class="signature-content" data-content="upload" style="display: none;">
                            <div class="upload-zone" id="signatureUploadZone" style="padding: 40px 20px;">
                                <i class="fas fa-image text-4xl mb-4 opacity-50"></i>
                                <p class="mb-4">Upload signature image</p>
                                <button class="btn-gradient">
                                    <i class="fas fa-upload mr-2"></i>Choose Image
                                </button>
                                <input type="file" id="signatureImageInput" accept="image/*" class="hidden">
                            </div>
                            <div id="uploadedSignaturePreview" class="hidden mt-4"></div>
                        </div>
                    </div>
                    
                    <!-- Saved Signatures -->
                    <div class="glass-card p-6 mb-6">
                        <h3 class="text-lg font-bold mb-4">
                            <i class="fas fa-bookmark mr-2"></i>
                            Saved Signatures
                        </h3>
                        <div id="savedSignatures" class="space-y-2">
                            <p class="text-sm opacity-70 text-center py-4">No signatures saved yet</p>
                        </div>
                    </div>
                    
                    <!-- Digital Certificate -->
                    <div class="glass-card p-6 mb-6">
                        <h3 class="text-lg font-bold mb-4">
                            <i class="fas fa-certificate mr-2"></i>
                            Digital Certificate
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium mb-2 block">Certificate Name:</label>
                                <input type="text" id="certName" class="input-field" placeholder="Enter certificate name">
                            </div>
                            <div>
                                <label class="text-sm font-medium mb-2 block">Organization:</label>
                                <input type="text" id="certOrg" class="input-field" placeholder="Enter organization">
                            </div>
                            <div class="flex items-center gap-2">
                                <input type="checkbox" id="addTimestamp" class="w-4 h-4 accent-purple-500">
                                <label for="addTimestamp" class="text-sm">Add timestamp validation</label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Actions -->
                    <div class="glass-card p-6">
                        <h3 class="text-lg font-bold mb-4">
                            <i class="fas fa-download mr-2"></i>
                            Finalize Document
                        </h3>
                        
                        <div class="space-y-3">
                            <button class="btn-gradient w-full" id="previewDocument">
                                <i class="fas fa-eye mr-2"></i>
                                Preview Signed Document
                            </button>
                            
                            <button class="btn-gradient w-full" id="downloadSignedPDF">
                                <i class="fas fa-download mr-2"></i>
                                Download Signed PDF
                            </button>
                            
                            <button class="btn-secondary w-full" id="startOver">
                                <i class="fas fa-redo mr-2"></i>
                                Start Over
                            </button>
                        </div>
                        
                        <div class="mt-4 p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg">
                            <div class="flex items-center gap-2 text-blue-400 text-sm">
                                <i class="fas fa-info-circle"></i>
                                <span>Click on the PDF to place signatures</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <script>
        // Theme Toggle
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            localStorage.setItem('theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
        }
        
        // Load saved theme
        if (localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light-theme');
        }
        
        // Particles Animation
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.width = particle.style.height = Math.random() * 10 + 5 + 'px';
                particle.style.animationDuration = Math.random() * 10 + 10 + 's';
                particle.style.animationDelay = Math.random() * 10 + 's';
                container.appendChild(particle);
            }
        }
        createParticles();
        
        // Global Variables
        let pdfDoc = null;
        let pageNum = 1;
        let pageCount = 0;
        let scale = 1.0;
        let canvas = null;
        let ctx = null;
        let signatureCanvas = null;
        let signatureCtx = null;
        let isDrawing = false;
        let savedSignatures = [];
        let placedSignatures = [];
        let currentSignature = null;
        
        // Initialize PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js';
        
        // File Upload Handling
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('pdfFileInput');
        const mainInterface = document.getElementById('mainInterface');
        
        uploadZone.addEventListener('click', () => fileInput.click());
        
        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        });
        
        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragover');
        });
        
        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type === 'application/pdf') {
                handleFileSelect(files[0]);
            }
        });
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileSelect(e.target.files[0]);
            }
        });
        
        function handleFileSelect(file) {
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            const uploadProgress = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('uploadProgressFill');
            
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            
            uploadProgress.classList.remove('hidden');
            
            // Simulate upload progress
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 30;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    
                    setTimeout(() => {
                        uploadProgress.classList.add('hidden');
                        fileInfo.classList.remove('hidden');
                        loadPDF(file);
                    }, 500);
                }
                progressFill.style.width = progress + '%';
            }, 100);
        }
        
        function formatFileSize(bytes) {
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            if (bytes === 0) return '0 Bytes';
            const i = Math.floor(Math.log(bytes) / Math.log(1024));
            return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        // PDF Loading and Rendering
        async function loadPDF(file) {
            try {
                const arrayBuffer = await file.arrayBuffer();
                pdfDoc = await pdfjsLib.getDocument(arrayBuffer).promise;
                pageCount = pdfDoc.numPages;
                
                canvas = document.getElementById('pdfCanvas');
                ctx = canvas.getContext('2d');
                
                updatePageInfo();
                renderPage();
                mainInterface.style.display = 'block';
                
                // Setup canvas click for signature placement
                setupCanvasInteraction();
                
            } catch (error) {
                console.error('Error loading PDF:', error);
                alert('Error loading PDF. Please try a different file.');
            }
        }
        
        async function renderPage() {
            if (!pdfDoc) return;
            
            try {
                const page = await pdfDoc.getPage(pageNum);
                const viewport = page.getViewport({ scale: scale });
                
                canvas.width = viewport.width;
                canvas.height = viewport.height;
                
                const renderContext = {
                    canvasContext: ctx,
                    viewport: viewport
                };
                
                await page.render(renderContext).promise;
                
                // Update overlay size
                const overlay = document.getElementById('signatureOverlay');
                overlay.style.width = viewport.width + 'px';
                overlay.style.height = viewport.height + 'px';
                
                // Re-render placed signatures
                renderPlacedSignatures();
                
            } catch (error) {
                console.error('Error rendering page:', error);
            }
        }
        
        function updatePageInfo() {
            document.getElementById('pageInfo').textContent = `${pageNum} / ${pageCount}`;
            document.getElementById('zoomLevel').textContent = Math.round(scale * 100) + '%';
        }
        
        // Navigation Controls
        document.getElementById('prevPage').addEventListener('click', () => {
            if (pageNum > 1) {
                pageNum--;
                updatePageInfo();
                renderPage();
            }
        });
        
        document.getElementById('nextPage').addEventListener('click', () => {
            if (pageNum < pageCount) {
                pageNum++;
                updatePageInfo();
                renderPage();
            }
        });
        
        document.getElementById('zoomIn').addEventListener('click', () => {
            scale = Math.min(scale + 0.25, 3.0);
            updatePageInfo();
            renderPage();
        });
        
        document.getElementById('zoomOut').addEventListener('click', () => {
            scale = Math.max(scale - 0.25, 0.5);
            updatePageInfo();
            renderPage();
        });
        
        // Signature Canvas Setup
        function initSignatureCanvas() {
            signatureCanvas = document.getElementById('signatureCanvas');
            signatureCtx = signatureCanvas.getContext('2d');
            
            signatureCtx.strokeStyle = '#000000';
            signatureCtx.lineWidth = 2;
            signatureCtx.lineCap = 'round';
            signatureCtx.lineJoin = 'round';
            
            // Clear signature canvas
            clearSignatureCanvas();
            
            // Drawing events
            signatureCanvas.addEventListener('mousedown', startDrawing);
            signatureCanvas.addEventListener('mousemove', draw);
            signatureCanvas.addEventListener('mouseup', stopDrawing);
            signatureCanvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events
            signatureCanvas.addEventListener('touchstart', handleTouch);
            signatureCanvas.addEventListener('touchmove', handleTouch);
            signatureCanvas.addEventListener('touchend', stopDrawing);
        }
        
        function clearSignatureCanvas() {
            signatureCtx.clearRect(0, 0, signatureCanvas.width, signatureCanvas.height);
            signatureCtx.fillStyle = '#ffffff';
            signatureCtx.fillRect(0, 0, signatureCanvas.width, signatureCanvas.height);
        }
        
        function startDrawing(e) {
            isDrawing = true;
            const rect = signatureCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            signatureCtx.beginPath();
            signatureCtx.moveTo(x, y);
        }
        
        function draw(e) {
            if (!isDrawing) return;
            
            const rect = signatureCanvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            signatureCtx.lineTo(x, y);
            signatureCtx.stroke();
        }
        
        function stopDrawing() {
            isDrawing = false;
            signatureCtx.beginPath();
        }
        
        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                           e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            signatureCanvas.dispatchEvent(mouseEvent);
        }
        
        // Pen Settings
        document.getElementById('penSize').addEventListener('input', (e) => {
            const size = e.target.value;
            signatureCtx.lineWidth = size;
            document.getElementById('penSizeDisplay').textContent = size + 'px';
        });
        
        document.getElementById('penColor').addEventListener('change', (e) => {
            signatureCtx.strokeStyle = e.target.value;
        });
        
        // Signature Tab Switching
        document.querySelectorAll('.signature-tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                const targetTab = e.target.dataset.tab;
                
                // Update active tab
                document.querySelectorAll('.signature-tab').forEach(t => t.classList.remove('active'));
                e.target.classList.add('active');
                
                // Show corresponding content
                document.querySelectorAll('.signature-content').forEach(content => {
                    content.style.display = 'none';
                });
                document.querySelector(`[data-content="${targetTab}"]`).style.display = 'block';
            });
        });
        
        // Clear Signature
        document.getElementById('clearSignature').addEventListener('click', clearSignatureCanvas);
        
        // Save Drawn Signature
        document.getElementById('saveSignature').addEventListener('click', () => {
            const canvas = document.getElementById('signatureCanvas');
            const imageData = canvas.toDataURL();
            
            if (isCanvasEmpty(canvas)) {
                alert('Please draw a signature first.');
                return;
            }
            
            saveSignatureToList(imageData, 'drawn');
            clearSignatureCanvas();
        });
        
        function isCanvasEmpty(canvas) {
            const context = canvas.getContext('2d');
            const pixelBuffer = new Uint32Array(
                context.getImageData(0, 0, canvas.width, canvas.height).data.buffer
            );
            return !pixelBuffer.some(color => color !== 0xffffffff && color !== 0x00000000);
        }
        
        // Text Signature
        document.getElementById('signatureText').addEventListener('input', updateTextSignature);
        document.getElementById('fontFamily').addEventListener('change', updateTextSignature);
        document.getElementById('fontSize').addEventListener('input', (e) => {
            document.getElementById('fontSizeDisplay').textContent = e.target.value + 'px';
            updateTextSignature();
        });
        
        function updateTextSignature() {
            const text = document.getElementById('signatureText').value || 'Your Signature';
            const fontFamily = document.getElementById('fontFamily').value;
            const fontSize = document.getElementById('fontSize').value;
            
            const preview = document.getElementById('textSignaturePreview');
            preview.textContent = text;
            preview.style.fontFamily = fontFamily;
            preview.style.fontSize = fontSize + 'px';
        }
        
        document.getElementById('saveTextSignature').addEventListener('click', () => {
            const text = document.getElementById('signatureText').value;
            if (!text.trim()) {
                alert('Please enter signature text.');
                return;
            }
            
            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 100;
            const ctx = canvas.getContext('2d');
            
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            const fontFamily = document.getElementById('fontFamily').value;
            const fontSize = document.getElementById('fontSize').value;
            
            ctx.fillStyle = '#000000';
            ctx.font = `${fontSize}px ${fontFamily}`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(text, canvas.width / 2, canvas.height / 2);
            
            const imageData = canvas.toDataURL();
            saveSignatureToList(imageData, 'text');
        });
        
        // Upload Signature Image
        document.getElementById('signatureUploadZone').addEventListener('click', () => {
            document.getElementById('signatureImageInput').click();
        });
        
        document.getElementById('signatureImageInput').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const imageData = e.target.result;
                const preview = document.getElementById('uploadedSignaturePreview');
                preview.innerHTML = `
                    <img src="${imageData}" alt="Signature" class="max-w-full max-h-32 mx-auto border rounded">
                    <button class="btn-gradient w-full mt-4" onclick="saveUploadedSignature('${imageData}')">
                        <i class="fas fa-save mr-2"></i>Save Uploaded Signature
                    </button>
                `;
                preview.classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        });
        
        function saveUploadedSignature(imageData) {
            saveSignatureToList(imageData, 'uploaded');
            document.getElementById('uploadedSignaturePreview').classList.add('hidden');
            document.getElementById('signatureImageInput').value = '';
        }
        
        // Save Signature to List
        function saveSignatureToList(imageData, type) {
            const signature = {
                id: Date.now(),
                data: imageData,
                type: type,
                timestamp: new Date().toLocaleString()
            };
            
            savedSignatures.push(signature);
            updateSavedSignaturesList();
        }
        
        function updateSavedSignaturesList() {
            const container = document.getElementById('savedSignatures');
            
            if (savedSignatures.length === 0) {
                container.innerHTML = '<p class="text-sm opacity-70 text-center py-4">No signatures saved yet</p>';
                return;
            }
            
            container.innerHTML = savedSignatures.map(sig => `
                <div class="signature-preview ${currentSignature?.id === sig.id ? 'active' : ''}" data-signature-id="${sig.id}">
                    <img src="${sig.data}" alt="Signature" class="max-h-12 mx-auto mb-2">
                    <div class="text-xs opacity-70 text-center mb-2">${sig.type} - ${sig.timestamp}</div>
                    <div class="flex gap-2">
                        <button class="btn-secondary flex-1 text-xs" onclick="selectSignature(${sig.id})">
                            <i class="fas fa-mouse-pointer mr-1"></i>Select
                        </button>
                        <button class="btn-secondary text-xs" onclick="deleteSignature(${sig.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function selectSignature(id) {
            const signature = savedSignatures.find(sig => sig.id === id);
            if (signature) {
                currentSignature = signature;
                updateSavedSignaturesList();
                
                // Show instruction
                showNotification('Click on the PDF to place your signature', 'info');
            }
        }
        
        function deleteSignature(id) {
            if (confirm('Are you sure you want to delete this signature?')) {
                savedSignatures = savedSignatures.filter(sig => sig.id !== id);
                if (currentSignature?.id === id) {
                    currentSignature = null;
                }
                updateSavedSignaturesList();
            }
        }
        
        // Canvas Interaction for Signature Placement
        function setupCanvasInteraction() {
            canvas.addEventListener('click', (e) => {
                if (!currentSignature) {
                    showNotification('Please select a signature first', 'warning');
                    return;
                }
                
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX - rect.left) / rect.width * canvas.width;
                const y = (e.clientY - rect.top) / rect.height * canvas.height;
                
                placeSignature(x, y);
            });
        }
        
        function placeSignature(x, y) {
            const signature = {
                id: Date.now(),
                signatureId: currentSignature.id,
                data: currentSignature.data,
                x: x,
                y: y,
                width: 120,
                height: 60,
                page: pageNum
            };
            
            placedSignatures.push(signature);
            renderPlacedSignatures();
            
            showNotification('Signature placed successfully', 'success');
        }
        
        function renderPlacedSignatures() {
            const overlay = document.getElementById('signatureOverlay');
            
            // Clear existing signatures
            overlay.innerHTML = '';
            
            // Render signatures for current page
            placedSignatures.filter(sig => sig.page === pageNum).forEach(sig => {
                const sigElement = document.createElement('div');
                sigElement.className = 'signature-positioned';
                sigElement.style.left = (sig.x / canvas.width * 100) + '%';
                sigElement.style.top = (sig.y / canvas.height * 100) + '%';
                sigElement.style.width = (sig.width / canvas.width * 100) + '%';
                sigElement.style.height = (sig.height / canvas.height * 100) + '%';
                sigElement.style.pointerEvents = 'auto';
                
                sigElement.innerHTML = `
                    <img src="${sig.data}" alt="Signature" class="w-full h-full object-contain">
                    <button class="delete-signature" onclick="removeSignature(${sig.id})">×</button>
                `;
                
                // Make draggable
                makeDraggable(sigElement, sig);
                
                overlay.appendChild(sigElement);
            });
        }
        
        function removeSignature(id) {
            placedSignatures = placedSignatures.filter(sig => sig.id !== id);
            renderPlacedSignatures();
            showNotification('Signature removed', 'success');
        }
        
        function makeDraggable(element, signature) {
            let isDragging = false;
            let startX, startY, initialLeft, initialTop;
            
            element.addEventListener('mousedown', (e) => {
                if (e.target.classList.contains('delete-signature')) return;
                
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                
                const rect = element.getBoundingClientRect();
                const parentRect = element.parentElement.getBoundingClientRect();
                
                initialLeft = rect.left - parentRect.left;
                initialTop = rect.top - parentRect.top;
                
                document.addEventListener('mousemove', handleDrag);
                document.addEventListener('mouseup', stopDrag);
            });
            
            function handleDrag(e) {
                if (!isDragging) return;
                
                const deltaX = e.clientX - startX;
                const deltaY = e.clientY - startY;
                
                const newLeft = initialLeft + deltaX;
                const newTop = initialTop + deltaY;
                
                const parentRect = element.parentElement.getBoundingClientRect();
                const maxLeft = parentRect.width - element.offsetWidth;
                const maxTop = parentRect.height - element.offsetHeight;
                
                const clampedLeft = Math.max(0, Math.min(newLeft, maxLeft));
                const clampedTop = Math.max(0, Math.min(newTop, maxTop));
                
                element.style.left = (clampedLeft / parentRect.width * 100) + '%';
                element.style.top = (clampedTop / parentRect.height * 100) + '%';
                
                // Update signature position
                signature.x = clampedLeft / parentRect.width * canvas.width;
                signature.y = clampedTop / parentRect.height * canvas.height;
            }
            
            function stopDrag() {
                isDragging = false;
                document.removeEventListener('mousemove', handleDrag);
                document.removeEventListener('mouseup', stopDrag);
            }
        }
        
        // Action Buttons
        document.getElementById('previewDocument').addEventListener('click', () => {
            showNotification('Document preview functionality would open in a new window', 'info');
        });
        
        document.getElementById('downloadSignedPDF').addEventListener('click', async () => {
            if (placedSignatures.length === 0) {
                showNotification('Please add at least one signature before downloading', 'warning');
                return;
            }
            
            try {
                await generateSignedPDF();
            } catch (error) {
                console.error('Error generating PDF:', error);
                showNotification('Error generating signed PDF', 'error');
            }
        });
        
        document.getElementById('startOver').addEventListener('click', () => {
            if (confirm('Are you sure you want to start over? All unsaved changes will be lost.')) {
                location.reload();
            }
        });
        
        // Generate Signed PDF
        async function generateSignedPDF() {
            showNotification('Generating signed PDF...', 'info');
            
            // For demonstration purposes, we'll download the original PDF
            // In a real implementation, you would use a PDF manipulation library
            // to embed the signatures into the PDF
            
            const fileName = document.getElementById('fileName').textContent;
            const newFileName = fileName.replace('.pdf', '_signed.pdf');
            
            // Create a blob URL for download
            const originalFile = fileInput.files[0];
            if (originalFile) {
                const url = URL.createObjectURL(originalFile);
                const a = document.createElement('a');
                a.href = url;
                a.download = newFileName;
                a.click();
                URL.revokeObjectURL(url);
                
                showNotification('Signed PDF downloaded successfully!', 'success');
            }
        }
        
        // Notification System
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-24 right-6 z-50 p-4 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full status-indicator status-${type}`;
            notification.innerHTML = `
                <div class="flex items-center gap-2">
                    <i class="fas fa-${type === 'success' ? 'check' : type === 'warning' ? 'exclamation-triangle' : type === 'error' ? 'times' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(full)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initSignatureCanvas();
            updateTextSignature();
            
            // Add active style to signature tabs
            const style = document.createElement('style');
            style.textContent = `
                .signature-tab.active {
                    background: var(--primary-gradient);
                    color: white;
                }
            `;
            document.head.appendChild(style);
        });
    </script>
<script src="/homebutton.js"></script>
</body>

</html>
