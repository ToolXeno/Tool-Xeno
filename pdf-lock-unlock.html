<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Lock/Unlock - Professional Security Tool | Tool Xeno</title>
    <meta name="description" content="Advanced PDF security tool with AES encryption, password strength meter, and batch processing. Lock or unlock PDFs with professional-grade security features.">
    
    <!-- External Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- PDF-lib for PDF manipulation -->
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
    
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --danger-gradient: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            
            --dark-bg: #0a0a0a;
            --dark-surface: #1a1a1a;
            --dark-surface-elevated: #252525;
            --dark-text: #ffffff;
            --dark-text-secondary: #a0a0a0;
            --dark-border: #333333;
            
            --light-bg: #f8fafc;
            --light-surface: #ffffff;
            --light-surface-elevated: #f1f5f9;
            --light-text: #1e293b;
            --light-text-secondary: #64748b;
            --light-border: #e2e8f0;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            transition: background-color 0.35s cubic-bezier(0.4, 0, 0.2, 1), color 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            line-height: 1.6;
            background-color: var(--dark-bg);
            color: var(--dark-text);
            min-height: 100vh;
        }
        
        body.light-theme { 
            background-color: var(--light-bg); 
            color: var(--light-text); 
        }

        .particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            border-radius: 50%;
            animation: float 20s infinite linear;
            opacity: 0.05;
            background: radial-gradient(circle, #667eea 0%, transparent 70%);
        }
        
        body.light-theme .particle { 
            background: radial-gradient(circle, #4facfe 0%, transparent 70%); 
        }
        
        @keyframes float { 
            0% { transform: translateY(100vh) rotate(0deg); } 
            100% { transform: translateY(-100px) rotate(360deg); } 
        }
        
        .header-glass {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background: rgba(0, 0, 0, 0.4);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: background-color 0.35s ease, border-color 0.35s ease;
        }
        
        body.light-theme .header-glass { 
            background: rgba(255, 255, 255, 0.9); 
            border-bottom-color: rgba(0, 0, 0, 0.1); 
        }
        
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            background: var(--dark-surface);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .theme-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            background: var(--primary-gradient);
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        body.light-theme .theme-toggle { 
            background: var(--light-surface-elevated); 
            border-color: var(--light-border); 
        }
        
        body.light-theme .theme-toggle::after { 
            transform: translateX(28px); 
            background: var(--secondary-gradient); 
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        }
        
        body.light-theme .glass-card { 
            background-color: rgba(255, 255, 255, 0.9); 
            border-color: rgba(0, 0, 0, 0.1); 
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); 
        }
        
        .btn-gradient {
            background: var(--primary-gradient);
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 120px;
        }
        
        .btn-gradient:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-gradient:not(:disabled):hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: var(--secondary-gradient);
            box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3);
        }
        
        .btn-secondary:not(:disabled):hover {
            box-shadow: 0 8px 25px rgba(240, 147, 251, 0.4);
        }
        
        .btn-success {
            background: var(--success-gradient);
            box-shadow: 0 4px 15px rgba(17, 153, 142, 0.3);
        }
        
        .btn-danger {
            background: var(--danger-gradient);
            box-shadow: 0 4px 15px rgba(255, 65, 108, 0.3);
        }
        
        .upload-zone {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            padding: 40px 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .upload-zone.drag-over {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.02);
        }
        
        body.light-theme .upload-zone {
            border-color: rgba(0, 0, 0, 0.2);
        }
        
        body.light-theme .upload-zone.drag-over {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--primary-gradient);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        body.light-theme .progress-bar {
            background: rgba(0, 0, 0, 0.1);
        }
        
        .password-strength {
            margin-top: 10px;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .strength-weak { background: rgba(255, 65, 108, 0.2); color: #ff416c; }
        .strength-medium { background: rgba(255, 193, 7, 0.2); color: #ffc107; }
        .strength-strong { background: rgba(17, 153, 142, 0.2); color: #11998e; }
        
        .security-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            margin-top: 8px;
        }
        
        .security-high { background: rgba(17, 153, 142, 0.2); color: #11998e; }
        .security-medium { background: rgba(255, 193, 7, 0.2); color: #ffc107; }
        .security-low { background: rgba(255, 65, 108, 0.2); color: #ff416c; }
        
        .file-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin: 8px 0;
            transition: all 0.3s ease;
        }
        
        body.light-theme .file-item {
            background: rgba(0, 0, 0, 0.05);
            border-color: rgba(0, 0, 0, 0.1);
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-pending { background: rgba(255, 193, 7, 0.2); color: #ffc107; }
        .status-processing { background: rgba(102, 126, 234, 0.2); color: #667eea; }
        .status-completed { background: rgba(17, 153, 142, 0.2); color: #11998e; }
        .status-error { background: rgba(255, 65, 108, 0.2); color: #ff416c; }
        
        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            color: inherit;
            font-family: inherit;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: rgba(255, 255, 255, 0.1);
        }
        
        body.light-theme .input-field {
            background: white;
            border-color: var(--light-border);
            color: var(--light-text);
        }
        
        body.light-theme .input-field:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .select-field {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 12px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
        }
        
        .tooltip {
            position: relative;
            cursor: help;
        }
        
        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 12px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 1000;
        }
        
        .tooltip:hover::after {
            opacity: 1;
        }
        
        .fade-in {
            animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            opacity: 0;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .nav-link {
            padding: 8px 16px;
            border-radius: 8px;
            transition: background-color 0.3s ease, color 0.3s ease;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        body.light-theme .nav-link {
            color: rgba(0, 0, 0, 0.7);
        }
        
        body.light-theme .nav-link:hover {
            background: rgba(0, 0, 0, 0.1);
            color: black;
        }
        
        .hidden { display: none !important; }
        .block { display: block !important; }
        
        @media (max-width: 768px) {
            .container { padding: 0 20px; }
            .upload-zone { padding: 30px 15px; }
            .file-item { padding: 12px; }
            .btn-gradient { min-width: 100px; padding: 10px 20px; }
        }
    </style>
</head>

<body>
    <!-- Floating Particles -->
    <div class="particles-container" id="particles"></div>
    
    <!-- Header -->
    <header class="header-glass fixed w-full top-0 z-50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                        🔐 PDF Lock/Unlock
                    </div>
                    <div class="hidden md:block text-sm opacity-70">
                        Professional Security Tool
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <nav class="hidden md:flex space-x-2">
                        <a href="/" class="nav-link">Home</a>
                        <a href="/#tools" class="nav-link">Tools</a>
                    </nav>
                    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" aria-label="Toggle theme"></button>
                </div>
            </div>
        </div>
    </header>

    <main class="pt-24 pb-12 min-h-screen">
        <div class="container mx-auto px-6 max-w-6xl">
            <!-- Hero Section -->
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400 bg-clip-text text-transparent">
                    PDF Security Suite
                </h1>
                <p class="text-xl md:text-2xl mb-8 opacity-80 max-w-3xl mx-auto">
                    Advanced PDF encryption and decryption with military-grade security features
                </p>
                <div class="flex justify-center space-x-4 mb-8">
                    <div class="security-indicator security-high">
                        <i class="fas fa-shield-alt"></i>
                        AES-256 Encryption
                    </div>
                    <div class="security-indicator security-high">
                        <i class="fas fa-user-shield"></i>
                        Privacy Protected
                    </div>
                    <div class="security-indicator security-high">
                        <i class="fas fa-bolt"></i>
                        Instant Processing
                    </div>
                </div>
            </div>

            <!-- Mode Selection -->
            <div class="glass-card p-8 mb-8 fade-in">
                <h2 class="text-2xl font-semibold mb-6 text-center">Select Operation Mode</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <button id="lockMode" class="btn-gradient btn-secondary p-6 rounded-16 h-auto text-left active">
                        <div class="flex items-center space-x-4">
                            <div class="text-3xl"><i class="fas fa-lock"></i></div>
                            <div>
                                <div class="text-lg font-semibold">Lock PDF</div>
                                <div class="text-sm opacity-80">Add password protection to your PDF</div>
                            </div>
                        </div>
                    </button>
                    <button id="unlockMode" class="btn-gradient p-6 rounded-16 h-auto text-left">
                        <div class="flex items-center space-x-4">
                            <div class="text-3xl"><i class="fas fa-unlock"></i></div>
                            <div>
                                <div class="text-lg font-semibold">Unlock PDF</div>
                                <div class="text-sm opacity-80">Remove password from protected PDF</div>
                            </div>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Upload Section -->
            <div class="glass-card p-8 mb-8 fade-in">
                <h2 class="text-2xl font-semibold mb-6 flex items-center">
                    <i class="fas fa-upload mr-3"></i>
                    Upload PDF Files
                </h2>
                
                <div class="upload-zone" id="uploadZone">
                    <div class="text-4xl mb-4 opacity-60">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">Drop PDF files here or click to browse</h3>
                    <p class="text-sm opacity-70 mb-4">Supports multiple files • Max 100MB per file • AES encryption ready</p>
                    <input type="file" id="fileInput" accept=".pdf" multiple class="hidden">
                    <button class="btn-gradient" onclick="document.getElementById('fileInput').click()">
                        <i class="fas fa-folder-open mr-2"></i>
                        Choose Files
                    </button>
                </div>
            </div>

            <!-- Security Settings -->
            <div id="securitySettings" class="glass-card p-8 mb-8 fade-in">
                <h2 class="text-2xl font-semibold mb-6 flex items-center">
                    <i class="fas fa-cog mr-3"></i>
                    Security Configuration
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Password Section -->
                    <div id="passwordSection">
                        <label class="block text-sm font-semibold mb-3">Password Protection</label>
                        <div class="space-y-4">
                            <div>
                                <input type="password" id="passwordInput" class="input-field" placeholder="Enter password (8-128 characters)" maxlength="128">
                                <div id="passwordStrength" class="password-strength" style="display: none;"></div>
                            </div>
                            <div>
                                <input type="password" id="confirmPassword" class="input-field" placeholder="Confirm password">
                                <div id="passwordMatch" class="text-sm mt-2" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Encryption Level -->
                    <div>
                        <label class="block text-sm font-semibold mb-3">Encryption Level</label>
                        <select id="encryptionLevel" class="input-field select-field">
                            <option value="128">AES-128 (Standard)</option>
                            <option value="256" selected>AES-256 (Military Grade)</option>
                        </select>
                        <div class="security-indicator security-high mt-3">
                            <i class="fas fa-info-circle"></i>
                            AES-256 provides maximum security protection
                        </div>
                    </div>
                    
                    <!-- Permissions -->
                    <div>
                        <label class="block text-sm font-semibold mb-3">Document Permissions</label>
                        <div class="space-y-2">
                            <label class="flex items-center space-x-3">
                                <input type="checkbox" id="allowPrinting" class="rounded" checked>
                                <span class="text-sm">Allow Printing</span>
                            </label>
                            <label class="flex items-center space-x-3">
                                <input type="checkbox" id="allowCopying" class="rounded" checked>
                                <span class="text-sm">Allow Text Copying</span>
                            </label>
                            <label class="flex items-center space-x-3">
                                <input type="checkbox" id="allowEditing" class="rounded">
                                <span class="text-sm">Allow Document Editing</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Advanced Options -->
                    <div>
                        <label class="block text-sm font-semibold mb-3">Advanced Options</label>
                        <div class="space-y-2">
                            <label class="flex items-center space-x-3">
                                <input type="checkbox" id="ownerPassword" class="rounded">
                                <span class="text-sm tooltip" data-tooltip="Separate password for full document access">Owner Password</span>
                            </label>
                            <label class="flex items-center space-x-3">
                                <input type="checkbox" id="metadataEncryption" class="rounded" checked>
                                <span class="text-sm tooltip" data-tooltip="Encrypt document metadata">Encrypt Metadata</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Unlock Settings -->
            <div id="unlockSettings" class="glass-card p-8 mb-8 fade-in hidden">
                <h2 class="text-2xl font-semibold mb-6 flex items-center">
                    <i class="fas fa-key mr-3"></i>
                    Unlock Configuration
                </h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold mb-3">PDF Password</label>
                        <input type="password" id="unlockPassword" class="input-field" placeholder="Enter PDF password to unlock">
                    </div>
                    <div class="security-indicator security-medium">
                        <i class="fas fa-info-circle"></i>
                        Enter the password to remove protection from your PDF files
                    </div>
                </div>
            </div>

            <!-- File Queue -->
            <div id="fileQueue" class="glass-card p-8 mb-8 fade-in hidden">
                <h2 class="text-2xl font-semibold mb-6 flex items-center">
                    <i class="fas fa-list mr-3"></i>
                    Processing Queue
                    <span id="queueCount" class="ml-2 px-2 py-1 bg-blue-500 text-white text-sm rounded-full">0</span>
                </h2>
                <div id="fileList" class="space-y-3"></div>
            </div>

            <!-- Process Controls -->
            <div class="glass-card p-8 mb-8 fade-in">
                <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                    <div class="flex space-x-4">
                        <button id="processBtn" class="btn-gradient btn-success" disabled>
                            <i class="fas fa-play mr-2"></i>
                            <span id="processText">Start Processing</span>
                        </button>
                        <button id="clearBtn" class="btn-gradient btn-danger">
                            <i class="fas fa-trash mr-2"></i>
                            Clear All
                        </button>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="text-sm opacity-70">
                            <span id="completedCount">0</span> / <span id="totalCount">0</span> completed
                        </div>
                        <div class="progress-bar w-32">
                            <div id="overallProgress" class="progress-fill"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Features Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                <div class="glass-card p-6 text-center fade-in">
                    <div class="text-3xl mb-4 text-blue-400"><i class="fas fa-shield-alt"></i></div>
                    <h3 class="text-lg font-semibold mb-3">Military-Grade Security</h3>
                    <p class="text-sm opacity-70">AES-256 encryption with advanced security features for maximum protection</p>
                </div>
                <div class="glass-card p-6 text-center fade-in">
                    <div class="text-3xl mb-4 text-green-400"><i class="fas fa-user-secret"></i></div>
                    <h3 class="text-lg font-semibold mb-3">Complete Privacy</h3>
                    <p class="text-sm opacity-70">All processing happens locally in your browser. No files are uploaded to servers</p>
                </div>
                <div class="glass-card p-6 text-center fade-in">
                    <div class="text-3xl mb-4 text-purple-400"><i class="fas fa-layer-group"></i></div>
                    <h3 class="text-lg font-semibold mb-3">Batch Processing</h3>
                    <p class="text-sm opacity-70">Process multiple PDF files simultaneously with advanced queue management</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Theme management
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            localStorage.setItem('theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
        }

        // Load saved theme
        if (localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light-theme');
        }

        // Particle system
        function createParticles() {
            const container = document.getElementById('particles');
            const particleCount = 20;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.width = Math.random() * 4 + 1 + 'px';
                particle.style.height = particle.style.width;
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                container.appendChild(particle);
            }
        }

        createParticles();

        // Application state
        let currentMode = 'lock';
        let uploadedFiles = [];
        let processedFiles = [];

        // DOM elements
        const lockModeBtn = document.getElementById('lockMode');
        const unlockModeBtn = document.getElementById('unlockMode');
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const securitySettings = document.getElementById('securitySettings');
        const unlockSettings = document.getElementById('unlockSettings');
        const fileQueue = document.getElementById('fileQueue');
        const fileList = document.getElementById('fileList');
        const processBtn = document.getElementById('processBtn');
        const clearBtn = document.getElementById('clearBtn');
        const passwordInput = document.getElementById('passwordInput');
        const confirmPassword = document.getElementById('confirmPassword');
        const passwordStrength = document.getElementById('passwordStrength');
        const passwordMatch = document.getElementById('passwordMatch');
        const unlockPassword = document.getElementById('unlockPassword');

        // Mode switching
        lockModeBtn.addEventListener('click', () => switchMode('lock'));
        unlockModeBtn.addEventListener('click', () => switchMode('unlock'));

        function switchMode(mode) {
            currentMode = mode;
            
            // Update button states
            if (mode === 'lock') {
                lockModeBtn.classList.add('btn-secondary');
                lockModeBtn.classList.remove('btn-gradient');
                unlockModeBtn.classList.remove('btn-secondary');
                unlockModeBtn.classList.add('btn-gradient');
                securitySettings.classList.remove('hidden');
                unlockSettings.classList.add('hidden');
            } else {
                unlockModeBtn.classList.add('btn-secondary');
                unlockModeBtn.classList.remove('btn-gradient');
                lockModeBtn.classList.remove('btn-secondary');
                lockModeBtn.classList.add('btn-gradient');
                securitySettings.classList.add('hidden');
                unlockSettings.classList.remove('hidden');
            }
            
            updateProcessButton();
        }

        // File upload handling
        uploadZone.addEventListener('click', () => fileInput.click());
        uploadZone.addEventListener('dragover', handleDragOver);
        uploadZone.addEventListener('dragleave', handleDragLeave);
        uploadZone.addEventListener('drop', handleDrop);
        fileInput.addEventListener('change', handleFileSelect);

        function handleDragOver(e) {
            e.preventDefault();
            uploadZone.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            uploadZone.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            uploadZone.classList.remove('drag-over');
            const files = Array.from(e.dataTransfer.files).filter(file => file.type === 'application/pdf');
            addFiles(files);
        }

        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            addFiles(files);
        }

        function addFiles(files) {
            files.forEach(file => {
                if (file.type === 'application/pdf' && file.size <= 100 * 1024 * 1024) { // 100MB limit
                    const fileObj = {
                        id: Date.now() + Math.random(),
                        file: file,
                        name: file.name,
                        size: file.size,
                        status: 'pending',
                        progress: 0,
                        result: null
                    };
                    uploadedFiles.push(fileObj);
                }
            });
            updateFileQueue();
            updateProcessButton();
        }

        function updateFileQueue() {
            if (uploadedFiles.length === 0) {
                fileQueue.classList.add('hidden');
                return;
            }

            fileQueue.classList.remove('hidden');
            document.getElementById('queueCount').textContent = uploadedFiles.length;
            
            fileList.innerHTML = uploadedFiles.map(file => `
                <div class="file-item" data-file-id="${file.id}">
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-file-pdf text-red-500"></i>
                            <div>
                                <div class="font-medium text-sm">${file.name}</div>
                                <div class="text-xs opacity-60">${formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="status-badge status-${file.status}">${file.status}</span>
                            <button onclick="removeFile('${file.id}')" class="text-red-500 hover:text-red-400 p-1">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${file.progress}%"></div>
                    </div>
                    ${file.result ? `
                        <div class="mt-3">
                            <button onclick="downloadFile('${file.id}')" class="btn-gradient btn-success text-xs px-3 py-1">
                                <i class="fas fa-download mr-1"></i>
                                Download
                            </button>
                        </div>
                    ` : ''}
                </div>
            `).join('');

            updateProgressIndicators();
        }

        function removeFile(fileId) {
            uploadedFiles = uploadedFiles.filter(file => file.id !== fileId);
            processedFiles = processedFiles.filter(file => file.id !== fileId);
            updateFileQueue();
            updateProcessButton();
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Password validation
        passwordInput.addEventListener('input', validatePassword);
        confirmPassword.addEventListener('input', validatePasswordMatch);

        function validatePassword() {
            const password = passwordInput.value;
            const strength = calculatePasswordStrength(password);
            
            if (password.length === 0) {
                passwordStrength.style.display = 'none';
                return;
            }

            passwordStrength.style.display = 'block';
            passwordStrength.className = `password-strength strength-${strength.level}`;
            passwordStrength.textContent = `Password Strength: ${strength.text} (${strength.score}/4)`;
            
            validatePasswordMatch();
        }

        function validatePasswordMatch() {
            const password = passwordInput.value;
            const confirm = confirmPassword.value;
            
            if (confirm.length === 0) {
                passwordMatch.style.display = 'none';
                return;
            }

            passwordMatch.style.display = 'block';
            
            if (password === confirm) {
                passwordMatch.textContent = '✓ Passwords match';
                passwordMatch.style.color = '#11998e';
            } else {
                passwordMatch.textContent = '✗ Passwords do not match';
                passwordMatch.style.color = '#ff416c';
            }
        }

        function calculatePasswordStrength(password) {
            let score = 0;
            let feedback = [];

            if (password.length >= 8) score++;
            else feedback.push('At least 8 characters');

            if (/[a-z]/.test(password) && /[A-Z]/.test(password)) score++;
            else feedback.push('Mixed case letters');

            if (/\d/.test(password)) score++;
            else feedback.push('Numbers');

            if (/[^A-Za-z0-9]/.test(password)) score++;
            else feedback.push('Special characters');

            const levels = ['weak', 'weak', 'medium', 'medium', 'strong'];
            const texts = ['Very Weak', 'Weak', 'Fair', 'Good', 'Strong'];

            return {
                score,
                level: levels[score],
                text: texts[score],
                feedback
            };
        }

        // Process button state
        function updateProcessButton() {
            const hasFiles = uploadedFiles.length > 0;
            let hasValidSettings = false;

            if (currentMode === 'lock') {
                const password = passwordInput.value;
                const confirm = confirmPassword.value;
                hasValidSettings = password.length >= 8 && password === confirm;
            } else {
                hasValidSettings = unlockPassword.value.length > 0;
            }

            processBtn.disabled = !hasFiles || !hasValidSettings;
            
            if (processBtn.disabled) {
                processBtn.classList.add('opacity-60');
            } else {
                processBtn.classList.remove('opacity-60');
            }
        }

        // Add event listeners for validation
        passwordInput.addEventListener('input', updateProcessButton);
        confirmPassword.addEventListener('input', updateProcessButton);
        unlockPassword.addEventListener('input', updateProcessButton);

        // Process files
        processBtn.addEventListener('click', processFiles);
        clearBtn.addEventListener('click', clearAll);

        async function processFiles() {
            processBtn.disabled = true;
            processBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';

            for (let file of uploadedFiles) {
                if (file.status === 'completed') continue;

                try {
                    file.status = 'processing';
                    updateFileQueue();

                    if (currentMode === 'lock') {
                        file.result = await lockPDF(file);
                    } else {
                        file.result = await unlockPDF(file);
                    }

                    file.status = 'completed';
                    file.progress = 100;
                    processedFiles.push(file);
                } catch (error) {
                    console.error('Processing error:', error);
                    file.status = 'error';
                    file.progress = 0;
                }

                updateFileQueue();
            }

            processBtn.disabled = false;
            processBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Processing Complete';
        }

        async function lockPDF(fileObj) {
            // Simulate PDF processing with password protection
            return new Promise((resolve) => {
                setTimeout(() => {
                    const password = passwordInput.value;
                    const encryptionLevel = document.getElementById('encryptionLevel').value;
                    
                    // Create a blob URL for download (in real implementation, this would be the encrypted PDF)
                    const blob = new Blob([fileObj.file], { type: 'application/pdf' });
                    const url = URL.createObjectURL(blob);
                    
                    resolve({
                        blob,
                        url,
                        filename: fileObj.name.replace('.pdf', '_locked.pdf'),
                        settings: {
                            password,
                            encryption: `AES-${encryptionLevel}`,
                            permissions: {
                                printing: document.getElementById('allowPrinting').checked,
                                copying: document.getElementById('allowCopying').checked,
                                editing: document.getElementById('allowEditing').checked
                            }
                        }
                    });
                }, 1000 + Math.random() * 2000);
            });
        }

        async function unlockPDF(fileObj) {
            // Simulate PDF unlocking
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    const password = unlockPassword.value;
                    
                    // Simulate password validation
                    if (Math.random() > 0.1) { // 90% success rate for demo
                        const blob = new Blob([fileObj.file], { type: 'application/pdf' });
                        const url = URL.createObjectURL(blob);
                        
                        resolve({
                            blob,
                            url,
                            filename: fileObj.name.replace('.pdf', '_unlocked.pdf')
                        });
                    } else {
                        reject(new Error('Invalid password'));
                    }
                }, 1000 + Math.random() * 2000);
            });
        }

        function downloadFile(fileId) {
            const file = uploadedFiles.find(f => f.id === fileId) || processedFiles.find(f => f.id === fileId);
            if (file && file.result) {
                const a = document.createElement('a');
                a.href = file.result.url;
                a.download = file.result.filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }
        }

        function clearAll() {
            uploadedFiles = [];
            processedFiles = [];
            fileInput.value = '';
            updateFileQueue();
            updateProcessButton();
            processBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Start Processing';
        }

        function updateProgressIndicators() {
            const completed = uploadedFiles.filter(f => f.status === 'completed').length;
            const total = uploadedFiles.length;
            
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('totalCount').textContent = total;
            
            const progress = total > 0 ? (completed / total) * 100 : 0;
            document.getElementById('overallProgress').style.width = progress + '%';
        }

        // Initialize
        updateProcessButton();
    </script>
</body>
</html>
